<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tip 24 - Add logic to your Testing in Production sites with PowerShell | Azure Tips and Tricks</title>
    <meta name="description" content="">
    <link rel="apple-touch-icon" sizes="57x57" href="/AzureTipsAndTricks/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/AzureTipsAndTricks/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/AzureTipsAndTricks/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/AzureTipsAndTricks/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/AzureTipsAndTricks/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/AzureTipsAndTricks/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/AzureTipsAndTricks/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/AzureTipsAndTricks/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/AzureTipsAndTricks/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/AzureTipsAndTricks/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/AzureTipsAndTricks/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/AzureTipsAndTricks/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/AzureTipsAndTricks/favicon-16x16.png">
  <link rel="manifest" href="/AzureTipsAndTricks/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/AzureTipsAndTricks/assets/css/0.styles.1250f1e7.css" as="style"><link rel="preload" href="/AzureTipsAndTricks/assets/js/app.7a7e22af.js" as="script"><link rel="preload" href="/AzureTipsAndTricks/assets/js/4.42b4ecad.js" as="script"><link rel="preload" href="/AzureTipsAndTricks/assets/js/107.af027264.js" as="script"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/10.23222809.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/100.ddaf5881.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/101.3910f2a3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/102.0cc078a5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/103.dfd01184.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/104.7ca14e05.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/105.670ed148.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/106.c583a9f6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/108.67e7b43e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/109.ed62da20.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/11.6c3c3634.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/110.7b0ef3b0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/111.abdb8b3d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/112.d2fb6a88.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/113.26b3b5ba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/114.2ed54a9b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/115.63d1f3de.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/116.bb73b468.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/117.746c2ef9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/118.07653087.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/119.64615149.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/12.9429b2c2.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/120.f72e863e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/121.f564262d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/122.97959a19.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/123.e1015006.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/124.57d67b77.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/125.a55838cd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/126.c9b5ff86.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/127.65e397ba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/128.dddb5a27.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/129.fd928465.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/13.b7bc317d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/130.7c8f2e21.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/131.7359b454.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/132.44afa56d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/133.34daac6a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/134.d598798b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/135.7eb0da11.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/136.0c38e8be.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/137.810e3df1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/138.5ca95b96.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/139.56a88fd5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/14.b230590d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/140.a719086d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/141.807e4966.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/142.9020d766.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/143.4f0ab89e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/144.5842d0bc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/145.8741e9c7.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/146.f34e7dcb.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/147.50367b4f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/148.697d55dc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/149.871e2399.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/15.557252a1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/150.2cc8bc52.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/151.768ae02f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/152.82b5532f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/153.6aef40ab.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/154.fde8dfb9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/155.56f59acb.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/156.e8f26a7d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/157.e268f2b9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/158.6c990a3c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/159.f7c931e5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/16.7f84482e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/160.11f571dd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/161.ba510586.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/162.59f55fae.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/163.21d846da.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/164.76a53b9b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/165.1e4e107d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/166.2b22491e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/167.d2f27af7.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/168.1a93745a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/169.f221a2d1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/17.7e91a93a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/170.1cc34784.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/171.c6e28183.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/172.831a605a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/173.4a038519.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/174.0c90071d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/175.93c72d4c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/176.90d4f6a5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/177.13c84c1e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/178.920ad430.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/179.0393df07.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/18.7bef39fb.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/180.2dade1ea.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/181.6c4222ac.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/182.a2c2966d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/183.edffc47f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/184.5e38b95c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/185.624bf7e3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/186.fe4406ba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/187.c5a958c1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/188.38d9fd9f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/189.709d6c40.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/19.46dfc23a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/20.0e54b2ed.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/21.82f0646b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/22.5468b0cd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/23.306f7f11.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/24.9745afe1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/25.e0ccf766.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/26.139b7914.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/27.349e78c4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/28.b33b3ecf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/29.738c517a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/3.64c8908f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/30.21aa3b90.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/31.456dafff.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/32.5e5c2357.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/33.855a61e1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/34.88cbc742.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/35.322c673c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/36.e46cb5f1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/37.323b694d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/38.a76be6e1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/39.4c4aafa9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/40.4662cb4e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/41.08b3e6bd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/42.fba510a5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/43.2e1b9a64.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/44.c90dd020.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/45.596cbfd0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/46.26f8abef.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/47.ec61cc18.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/48.ec18b3cd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/49.5df9c0cd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/5.a3f2d69b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/50.b09e34ff.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/51.80ddb1dc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/52.863b133d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/53.c02e1c08.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/54.0f34c4f4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/55.b9054605.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/56.5e2720f2.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/57.826b5c94.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/58.cb976df8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/59.450e92ea.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/6.c702ed47.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/60.52d33982.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/61.9b69c59a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/62.11f146c8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/63.bd5b4bd4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/64.7069a086.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/65.a80d504d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/66.5da239ba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/67.a187df63.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/68.80620960.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/69.12d395c3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/7.ee00b141.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/70.b0a2f18e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/71.48fd58e7.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/72.e56b0aec.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/73.9385f7c3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/74.6fb05b46.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/75.c9ccd16c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/76.05fe560b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/77.147f3b57.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/78.c199b25a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/79.34927e83.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/8.df585746.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/80.55de8772.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/81.0f7b971e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/82.fe83f522.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/83.ae13f7a9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/84.280799e7.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/85.b63ba098.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/86.19efe625.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/87.e5b423b4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/88.5cd6734d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/89.4c374d7d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/9.33d043c0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/90.1f70aa86.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/91.17e85a16.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/92.7c6bc3a8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/93.94871473.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/94.98fbefbf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/95.67455494.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/96.b158e44c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/97.e49e14c5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/98.e028352a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/99.4b7dfe5c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/vendors~docsearch.9a8918f9.js">
    <link rel="stylesheet" href="/AzureTipsAndTricks/assets/css/0.styles.1250f1e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AzureTipsAndTricks/" class="home-link router-link-active"><!----> <span class="site-name">Azure Tips and Tricks</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/AzureTipsAndTricks/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://videos.azuredev.tips" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Videos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/AzureTipsAndTricks/#site-map" class="nav-link">eBooks</a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Questions?
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/rss.xml" class="nav-link">
  RSS Feed
</a></div> <a href="https://github.com/microsoft/azuretipsandtricks" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/AzureTipsAndTricks/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://videos.azuredev.tips" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Videos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/AzureTipsAndTricks/#site-map" class="nav-link">eBooks</a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Questions?
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/rss.xml" class="nav-link">
  RSS Feed
</a></div> <a href="https://github.com/microsoft/azuretipsandtricks" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Home</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/AzureTipsAndTricks/" class="sidebar-link">Welcome</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Tips</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Recently Added</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>AzCopy</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>App Service</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CLI</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cloud Shell</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cognitive Services</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Containers</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cosmos DB</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>DevOps</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Functions</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HD Insight</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>IoT</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Key Vault</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Logic Apps</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Media Services</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Portal</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>PowerShell</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/AzureTipsAndTricks/blog/tip24.html" class="active sidebar-link">Tip 24 - Add logic to your Testing in Production sites with PowerShell</a></li><li><a href="/AzureTipsAndTricks/blog/tip120.html" class="sidebar-link">Tip 120 - Run Azure PowerShell Cmdlets in Visual Studio 2017</a></li><li><a href="/AzureTipsAndTricks/blog/tip137.html" class="sidebar-link">Tip 137 - Export Azure Resources to CSV files with PowerShell</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Productivity</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SAP</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SendGrid</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SignalR</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SQL</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Storage</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Virtual Machines</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>VNET</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content default"><h4 id="intro"><a href="#intro" aria-hidden="true" class="header-anchor">#</a> Intro</h4> <p>We've recently created a <a href="http://www.michaelcrump.net/azure-tips-and-tricks19/" target="_blank" rel="noopener noreferrer">web app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and uploaded it to Azure App Service. We also took a look at <a href="http://www.michaelcrump.net/azure-tips-and-tricks20/" target="_blank" rel="noopener noreferrer">multiple ways<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to examine those files through the Azure portal interface and how we'd add <a href="http://www.michaelcrump.net/azure-tips-and-tricks21/" target="_blank" rel="noopener noreferrer">extensions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="http://www.michaelcrump.net/azure-tips-and-tricks22/" target="_blank" rel="noopener noreferrer">deployment slots<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for our web app. We also took a look at a feature called <a href="http://www.michaelcrump.net/azure-tips-and-tricks23/" target="_blank" rel="noopener noreferrer">Testing in Production<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which allows us to distribute traffic between our production and other slots. In this post, we'll look at adding additional logic by using PowerShell to automatically distribute the load between your Production and deployment slot sites with the Testing in Production feature.</p> <h4 id="install-the-powershell-azure-cli-first"><a href="#install-the-powershell-azure-cli-first" aria-hidden="true" class="header-anchor">#</a> Install the PowerShell Azure CLI first</h4> <p><strong>Hold up!</strong> You'll want to take a look at the <a href="http://www.michaelcrump.net/azure-tips-and-tricks22/" target="_blank" rel="noopener noreferrer">deployment slots<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and the <a href="http://www.michaelcrump.net/azure-tips-and-tricks23/" target="_blank" rel="noopener noreferrer">Testing in Production<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> post to have context on what we're going to do here.</p> <p>Go to the <a href="https://azure.github.io/projects/clis/" target="_blank" rel="noopener noreferrer">Azure CLI Projects page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and select select the WebPI Installer  or use the PowerShell gallery to bring together the power of Windows PowerShell and Azure.</p> <p>Once it has been setup, type <code>az</code> from your PowerShell Window to see the shiny new way to interact with Azure.</p> <img src="/AzureTipsAndTricks/files/powershellcli1.png"> <h4 id="powershell-azure-app-service-your-web-app-win"><a href="#powershell-azure-app-service-your-web-app-win" aria-hidden="true" class="header-anchor">#</a> PowerShell + Azure App Service + Your Web App = Win</h4> <p>Keep in mine that we <a href="http://www.michaelcrump.net/azure-tips-and-tricks23/" target="_blank" rel="noopener noreferrer">left off<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with  two versions of our site. One that is <code>production</code> and <code>staging</code>. They are identical except for the staging site has a large font that says <code>jsQuizEngine version 2</code>. We just <strong>distributed</strong> traffic manually between the two sites by going into the Azure Portal and changing this value from the Testing in Production blade.</p> <img src="/AzureTipsAndTricks/files/testinprodazure7.png"> <p>But what if we would like to generate rules to do this automatically where someone doesn't have to be inside the Portal manually changing this number?</p> <p>That is where PowerShell and the Azure CLI comes to the rescue. The CLI is great for automation of tasks such as this one. Begin by opening PowerShell and logging in with <code>Add-AzureAccount</code>. It will ask to authenticate you.  After authenticated, then set the proper subscription by using <code>Select-AzureSubscription -Default -SubscriptionName &quot;whatsubscriptionnameyouwanttouse&quot;</code>. Now run the following script editing only the <code>siteName</code> parameter to match whatever you called your app.</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token variable">$siteName</span> = <span class="token string">&quot;MyQuizApplication&quot;</span>
<span class="token variable">$rulesList</span> = <span class="token function">New-Object</span> <span class="token operator">-</span>TypeName System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">.</span>List<span class="token namespace">[Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule]</span>
<span class="token variable">$rule</span> = <span class="token function">New-Object</span> <span class="token operator">-</span>TypeName Microsoft<span class="token punctuation">.</span>WindowsAzure<span class="token punctuation">.</span>Commands<span class="token punctuation">.</span>Utilities<span class="token punctuation">.</span>Websites<span class="token punctuation">.</span>Services<span class="token punctuation">.</span>WebEntities<span class="token punctuation">.</span>RampUpRule
<span class="token variable">$rule</span><span class="token punctuation">.</span>Name = <span class="token string">&quot;stage&quot;</span>
<span class="token variable">$rule</span><span class="token punctuation">.</span>ActionHostName = <span class="token string">&quot;<span class="token variable">$siteName</span>-staging.azurewebsites.net&quot;</span>
<span class="token variable">$rule</span><span class="token punctuation">.</span>ReroutePercentage = 90
<span class="token variable">$rulesList</span><span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token variable">$rule</span><span class="token punctuation">)</span>
<span class="token function">Set</span><span class="token operator">-</span>AzureWebsite <span class="token operator">-</span>RoutingRules <span class="token variable">$rulesList</span> <span class="token operator">-</span>Name <span class="token variable">$siteName</span> <span class="token operator">-</span>Slot production
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>If you open the Azure Portal and navigate to your site page and then <code>Testing in Production</code> then you'll see the percentage is automatically updated to 90% after the command runs.</p> <img src="/AzureTipsAndTricks/files/powershellcli2.gif"> <p><strong>What did the script do again?</strong> This script added a rule for our staging environment that set the <code>staging</code> route to a hard coded value of <code>90%</code>.</p> <p>If you wanted to scale this number up, for instance, start at 5% for 60 minutes and then increase the value by 5% until the traffic reaches 50% for that slot. You could do so with this script.</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token variable">$siteName</span> = <span class="token string">&quot;MyQuizApplication&quot;</span>
<span class="token variable">$rule1</span> = <span class="token function">New-Object</span> Microsoft<span class="token punctuation">.</span>WindowsAzure<span class="token punctuation">.</span>Commands<span class="token punctuation">.</span>Utilities<span class="token punctuation">.</span>Websites<span class="token punctuation">.</span>Services<span class="token punctuation">.</span>WebEntities<span class="token punctuation">.</span>RampUpRule
<span class="token variable">$rule1</span><span class="token punctuation">.</span>ActionHostName = <span class="token string">&quot;<span class="token variable">$siteName</span>-staging.azurewebsites.net&quot;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>ReroutePercentage = 5<span class="token punctuation">;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>Name = <span class="token string">&quot;stage&quot;</span>
 
<span class="token variable">$rule1</span><span class="token punctuation">.</span>ChangeIntervalInMinutes = 60<span class="token punctuation">;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>ChangeStep = 5<span class="token punctuation">;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>MinReroutePercentage = 5<span class="token punctuation">;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>MaxReroutePercentage = 50<span class="token punctuation">;</span>
<span class="token variable">$rule1</span><span class="token punctuation">.</span>ChangeDecisionCallbackUrl = <span class="token variable">$null</span>
 
<span class="token function">Set</span><span class="token operator">-</span>AzureWebsite <span class="token variable">$siteName</span> <span class="token operator">-</span>Slot Production <span class="token operator">-</span>RoutingRules <span class="token variable">$rule1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Notice that we only changed 5 lines here to get that functionality.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/microsoft/azuretipsandtricks/edit/master/blog/tip24.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/AzureTipsAndTricks/blog/tip116.html" class="prev">
          Tip 116 - Easily Upload and download Azure dashboards
        </a></span> <span class="next"><a href="/AzureTipsAndTricks/blog/tip120.html">
          Tip 120 - Run Azure PowerShell Cmdlets in Visual Studio 2017
        </a>
        →
      </span></p></div> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/AzureTipsAndTricks/assets/js/app.7a7e22af.js" defer></script><script src="/AzureTipsAndTricks/assets/js/4.42b4ecad.js" defer></script><script src="/AzureTipsAndTricks/assets/js/107.af027264.js" defer></script>
  </body>
</html>
